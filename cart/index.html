<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Shopping Cart - Shauna McNally">
    <title>Cart | Shauna McNally</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body class="cart-page">
    <div class="container">
        <header>
            <nav class="menu" role="navigation" aria-label="Main navigation">
                <a href="/index.html" class="logo">ShaunaMcNally.Com</a>
                <div class="menu-links">
                    <a href="/about/index.html" class="site-link">About</a>
                    <a href="/cart/index.html" class="site-link">Cart</a>
                </div>
            </nav>
        </header>

        <main>
            <article class="artwork-page">
                <h1>Cart</h1>

                <section id="cart-items-section" class="cart-section">
                    <div id="cart-items-container">
                        <!-- Cart items will be dynamically inserted here -->
                    </div>
                    <div id="cart-total" class="cart-total">
                        <p><strong>Total: <span id="total-price">€0.00</span></strong></p>
                    </div>
                    <div class="purchase-buttons">
                        <button 
                            type="button" 
                            class="btn btn-primary" 
                            id="checkout-btn"
                            onclick="proceedToCheckout()"
                            aria-label="Proceed to checkout"
                        >
                            Proceed to Checkout
                        </button>
                        <button 
                            type="button" 
                            class="btn btn-secondary" 
                            id="clear-cart-btn"
                            onclick="clearCart()"
                            aria-label="Clear all items from cart"
                        >
                            Clear Cart
                        </button>
                        <button 
                            type="button" 
                            class="btn btn-secondary" 
                            onclick="window.location.href='/index.html'"
                            aria-label="Continue shopping"
                        >
                            Continue Shopping
                        </button>
                    </div>
                </section>

                <section id="empty-cart-message" class="cart-section" style="display: none; text-align: center;">
                    <p>Your cart is empty.</p>
                    <div class="purchase-buttons">
                        <button 
                            type="button" 
                            class="btn btn-primary" 
                            onclick="window.location.href='/index.html'"
                            aria-label="Continue shopping"
                        >
                            Continue Shopping
                        </button>
                    </div>
                </section>

                <section class="artwork-list">
                    <h2 style="font-size: 1.5rem; margin-bottom: 1.5rem; text-align: center;">Available Prints</h2>
                    <ul class="artwork-items">
                        <li class="artwork-item">
                            <div class="cart-item-row">
                                <div class="cart-item-row-content">
                                    <a href="/time-for-everything/index.html" class="artwork-link">
                                        <span class="artwork-title">Time For Everything</span>
                                    </a>
                                    <span class="cart-item-price">€70.00</span>
                                </div>
                                <button 
                                    type="button" 
                                    class="btn btn-primary cart-item-button" 
                                    onclick="addItemToCart('prod_THxuZf4QLqQZjx')"
                                    aria-label="Add Time For Everything to cart"
                                >
                                    Add to Cart
                                </button>
                            </div>
                        </li>
                        <li class="artwork-item">
                            <div class="cart-item-row">
                                <div class="cart-item-row-content">
                                    <a href="/the-entity/index.html" class="artwork-link">
                                        <span class="artwork-title">The Entity</span>
                                    </a>
                                    <span class="cart-item-price">€70.00</span>
                                </div>
                                <button 
                                    type="button" 
                                    class="btn btn-primary cart-item-button" 
                                    onclick="addItemToCart('prod_THxtUYehCZREGs')"
                                    aria-label="Add The Entity to cart"
                                >
                                    Add to Cart
                                </button>
                            </div>
                        </li>
                        <li class="artwork-item">
                            <div class="cart-item-row">
                                <div class="cart-item-row-content">
                                    <a href="/the-beginning-of-the-end/index.html" class="artwork-link">
                                        <span class="artwork-title">The Beginning of the End</span>
                                    </a>
                                    <span class="cart-item-price">€70.00</span>
                                </div>
                                <button 
                                    type="button" 
                                    class="btn btn-primary cart-item-button" 
                                    onclick="addItemToCart('prod_THxt1F5RED4cA0')"
                                    aria-label="Add The Beginning of the End to cart"
                                >
                                    Add to Cart
                                </button>
                            </div>
                        </li>
                        <li class="artwork-item">
                            <div class="cart-item-row">
                                <div class="cart-item-row-content">
                                    <a href="/sunrise/index.html" class="artwork-link">
                                        <span class="artwork-title">Sunrise</span>
                                    </a>
                                    <span class="cart-item-price">€30.00</span>
                                </div>
                                <button 
                                    type="button" 
                                    class="btn btn-primary cart-item-button" 
                                    onclick="addItemToCart('prod_THxs9v5Opt7nLE')"
                                    aria-label="Add Sunrise to cart"
                                >
                                    Add to Cart
                                </button>
                            </div>
                        </li>
                        <li class="artwork-item">
                            <div class="cart-item-row">
                                <div class="cart-item-row-content">
                                    <a href="/stop-act-natural/index.html" class="artwork-link">
                                        <span class="artwork-title">Stop Act Natural</span>
                                    </a>
                                    <span class="cart-item-price">€70.00</span>
                                </div>
                                <button 
                                    type="button" 
                                    class="btn btn-primary cart-item-button" 
                                    onclick="addItemToCart('prod_THxsLAj73IHzkE')"
                                    aria-label="Add Stop Act Natural to cart"
                                >
                                    Add to Cart
                                </button>
                            </div>
                        </li>
                        <li class="artwork-item">
                            <div class="cart-item-row">
                                <div class="cart-item-row-content">
                                    <a href="/reflections-of-another-time/index.html" class="artwork-link">
                                        <span class="artwork-title">Reflections Of Another Time</span>
                                    </a>
                                    <span class="cart-item-price">€70.00</span>
                                </div>
                                <button 
                                    type="button" 
                                    class="btn btn-primary cart-item-button" 
                                    onclick="addItemToCart('prod_THxrYIKdiioCj0')"
                                    aria-label="Add Reflections Of Another Time to cart"
                                >
                                    Add to Cart
                                </button>
                            </div>
                        </li>
                        <li class="artwork-item">
                            <div class="cart-item-row">
                                <div class="cart-item-row-content">
                                    <a href="/pearse-station/index.html" class="artwork-link">
                                        <span class="artwork-title">Pearse Station</span>
                                    </a>
                                    <span class="cart-item-price">€70.00</span>
                                </div>
                                <button 
                                    type="button" 
                                    class="btn btn-primary cart-item-button" 
                                    onclick="addItemToCart('prod_THxro1C7XRM9az')"
                                    aria-label="Add Pearse Station to cart"
                                >
                                    Add to Cart
                                </button>
                            </div>
                        </li>
                        <li class="artwork-item">
                            <div class="cart-item-row">
                                <div class="cart-item-row-content">
                                    <a href="/past-the-fairy-tree/index.html" class="artwork-link">
                                        <span class="artwork-title">Past The Fairy Tree</span>
                                    </a>
                                    <span class="cart-item-price">€70.00</span>
                                </div>
                                <button 
                                    type="button" 
                                    class="btn btn-primary cart-item-button" 
                                    onclick="addItemToCart('prod_THxqRtGSS6Vmpe')"
                                    aria-label="Add Past The Fairy Tree to cart"
                                >
                                    Add to Cart
                                </button>
                            </div>
                        </li>
                        <li class="artwork-item">
                            <div class="cart-item-row">
                                <div class="cart-item-row-content">
                                    <a href="/infinite-possibilities/index.html" class="artwork-link">
                                        <span class="artwork-title">Infinite Possibilities</span>
                                    </a>
                                    <span class="cart-item-price">€70.00</span>
                                </div>
                                <button 
                                    type="button" 
                                    class="btn btn-primary cart-item-button" 
                                    onclick="addItemToCart('prod_THxqmYzRyyk3nj')"
                                    aria-label="Add Infinite Possibilities to cart"
                                >
                                    Add to Cart
                                </button>
                            </div>
                        </li>
                        <li class="artwork-item">
                            <div class="cart-item-row">
                                <div class="cart-item-row-content">
                                    <a href="/dream-junction/index.html" class="artwork-link">
                                        <span class="artwork-title">Dream Junction</span>
                                    </a>
                                    <span class="cart-item-price">€70.00</span>
                                </div>
                                <button 
                                    type="button" 
                                    class="btn btn-primary cart-item-button" 
                                    onclick="addItemToCart('prod_THxpTmKXkUy4hv')"
                                    aria-label="Add Dream Junction to cart"
                                >
                                    Add to Cart
                                </button>
                            </div>
                        </li>
                        <li class="artwork-item">
                            <div class="cart-item-row">
                                <div class="cart-item-row-content">
                                    <a href="/away-with-the-faries/index.html" class="artwork-link">
                                        <span class="artwork-title">Away with the Faries</span>
                                    </a>
                                    <span class="cart-item-price">€70.00</span>
                                </div>
                                <button 
                                    type="button" 
                                    class="btn btn-primary cart-item-button" 
                                    onclick="addItemToCart('prod_THxmI6LnBR3JaD')"
                                    aria-label="Add Away with the Faries to cart"
                                >
                                    Add to Cart
                                </button>
                            </div>
                        </li>
                        <li class="artwork-item">
                            <div class="cart-item-row">
                                <div class="cart-item-row-content">
                                    <a href="/a-place-to-escape-to/index.html" class="artwork-link">
                                        <span class="artwork-title">A Place To Escape To</span>
                                    </a>
                                    <span class="cart-item-price">€70.00</span>
                                </div>
                                <button 
                                    type="button" 
                                    class="btn btn-primary cart-item-button" 
                                    onclick="addItemToCart('prod_THxmm6GeFBK9cj')"
                                    aria-label="Add A Place To Escape To to cart"
                                >
                                    Add to Cart
                                </button>
                            </div>
                        </li>
                        <li class="artwork-item">
                            <div class="cart-item-row">
                                <div class="cart-item-row-content">
                                    <a href="/big-rock-candy-mountain/index.html" class="artwork-link">
                                        <span class="artwork-title">Big Rock Candy Mountain</span>
                                    </a>
                                    <span class="cart-item-price">€70.00</span>
                                </div>
                                <button 
                                    type="button" 
                                    class="btn btn-primary cart-item-button" 
                                    onclick="addItemToCart('prod_THiit7KwAsGYoi')"
                                    aria-label="Add Big Rock Candy Mountain to cart"
                                >
                                    Add to Cart
                                </button>
                            </div>
                        </li>
                        <li class="artwork-item">
                            <div class="cart-item-row">
                                <div class="cart-item-row-content">
                                    <a href="/garden-of-kevinity/index.html" class="artwork-link">
                                        <span class="artwork-title">Garden of Kevinity</span>
                                    </a>
                                    <span class="cart-item-price">€90.00</span>
                                </div>
                                <button 
                                    type="button" 
                                    class="btn btn-primary cart-item-button" 
                                    onclick="addItemToCart('prod_THihQygkuRpT4G')"
                                    aria-label="Add Garden of Kevinity to cart"
                                >
                                    Add to Cart
                                </button>
                            </div>
                        </li>
                        <li class="artwork-item">
                            <div class="cart-item-row">
                                <div class="cart-item-row-content">
                                    <a href="/if-only-i-was-a-giant-dinosaur/index.html" class="artwork-link">
                                        <span class="artwork-title">If Only I Was a Giant Dinosaur</span>
                                    </a>
                                    <span class="cart-item-price">€70.00</span>
                                </div>
                                <button 
                                    type="button" 
                                    class="btn btn-primary cart-item-button" 
                                    onclick="addItemToCart('prod_THigAUxOVR7lIH')"
                                    aria-label="Add If Only I Was a Giant Dinosaur to cart"
                                >
                                    Add to Cart
                                </button>
                            </div>
                        </li>
                        <li class="artwork-item">
                            <div class="cart-item-row">
                                <div class="cart-item-row-content">
                                    <a href="/club-mc-meowlys/index.html" class="artwork-link">
                                        <span class="artwork-title">Club Mc Meowly's</span>
                                    </a>
                                    <span class="cart-item-price">€90.00</span>
                                </div>
                                <button 
                                    type="button" 
                                    class="btn btn-primary cart-item-button" 
                                    onclick="addItemToCart('prod_THieNC4E5rjJ2I')"
                                    aria-label="Add Club Mc Meowly's to cart"
                                >
                                    Add to Cart
                                </button>
                            </div>
                        </li>
                        <li class="artwork-item">
                            <div class="cart-item-row">
                                <div class="cart-item-row-content">
                                    <a href="/mc-meowlys-lounge/index.html" class="artwork-link">
                                        <span class="artwork-title">Mc Meowly's Lounge</span>
                                    </a>
                                    <span class="cart-item-price">€90.00</span>
                                </div>
                                <button 
                                    type="button" 
                                    class="btn btn-primary cart-item-button" 
                                    onclick="addItemToCart('prod_THhx0dGKpMBzjA')"
                                    aria-label="Add Mc Meowly's Lounge to cart"
                                >
                                    Add to Cart
                                </button>
                            </div>
                        </li>
                        <li class="artwork-item">
                            <div class="cart-item-row">
                                <div class="cart-item-row-content">
                                    <a href="/oh-dorothy/index.html" class="artwork-link">
                                        <span class="artwork-title">Oh Dorothy</span>
                                    </a>
                                    <span class="cart-item-price">€70.00</span>
                                </div>
                                <button 
                                    type="button" 
                                    class="btn btn-primary cart-item-button" 
                                    onclick="addItemToCart('prod_THhw4MKoZ3jkk9')"
                                    aria-label="Add Oh Dorothy to cart"
                                >
                                    Add to Cart
                                </button>
                            </div>
                        </li>
                    </ul>
                </section>
            </article>
        </main>
    </div>

    <script src="/script.js"></script>
    <script>
        // Cart display functions
        function displayCart() {
            const cart = getCart();
            const cartItemsContainer = document.getElementById('cart-items-container');
            const cartTotal = document.getElementById('total-price');
            const cartSection = document.getElementById('cart-items-section');
            const emptyCartMessage = document.getElementById('empty-cart-message');
            
            if (!cart || cart.length === 0) {
                cartSection.style.display = 'none';
                emptyCartMessage.style.display = 'block';
                return;
            }
            
            cartSection.style.display = 'block';
            emptyCartMessage.style.display = 'none';
            
            cartItemsContainer.innerHTML = '';
            let total = 0;
            
            cart.forEach((item, index) => {
                const itemElement = document.createElement('div');
                itemElement.className = 'cart-item';
                
                const itemInfo = document.createElement('div');
                itemInfo.className = 'cart-item-info';
                itemInfo.innerHTML = `
                    <p><strong>${item.name || 'Print'}</strong></p>
                    <p>€${item.price || '30.00'}</p>
                `;
                
                const itemActions = document.createElement('div');
                itemActions.className = 'cart-item-actions';
                
                const removeBtn = document.createElement('button');
                removeBtn.type = 'button';
                removeBtn.className = 'btn btn-secondary';
                removeBtn.textContent = 'Remove';
                removeBtn.onclick = () => removeFromCart(index);
                
                itemActions.appendChild(removeBtn);
                itemElement.appendChild(itemInfo);
                itemElement.appendChild(itemActions);
                cartItemsContainer.appendChild(itemElement);
                
                total += parseFloat(item.price || 30.00);
            });
            
            cartTotal.textContent = `€${total.toFixed(2)}`;
        }
        
        function removeFromCart(index) {
            const cart = getCart();
            cart.splice(index, 1);
            saveCart(cart);
            displayCart();
        }
        
        function clearCart() {
            if (confirm('Are you sure you want to clear all items from your cart?')) {
                localStorage.removeItem('cart');
                displayCart();
            }
        }
        
        async function proceedToCheckout() {
            const cart = getCart();
            if (!cart || cart.length === 0) {
                alert('Your cart is empty.');
                return;
            }
            
            // Disable the checkout button to prevent multiple clicks
            const checkoutBtn = document.getElementById('checkout-btn');
            if (checkoutBtn) {
                checkoutBtn.disabled = true;
                checkoutBtn.textContent = 'Processing...';
            }
            
            try {
                // Get the worker URL - update this with your actual Cloudflare Worker URL
                // For example: https://shauna-mcnally-checkout.your-subdomain.workers.dev
                const workerUrl = '/api/checkout'; // This will be your worker route
                
                // If you're using a custom domain, use that instead
                // const workerUrl = 'https://api.shauna-mcnally.com/checkout';
                
                const response = await fetch(workerUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        cart: cart,
                        successUrl: window.location.origin + '/cart/index.html?success=true',
                        cancelUrl: window.location.origin + '/cart/index.html?canceled=true',
                    }),
                });
                
                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error || 'Failed to create checkout session');
                }
                
                const data = await response.json();
                
                // Redirect to Stripe Checkout
                if (data.url) {
                    window.location.href = data.url;
                } else {
                    throw new Error('No checkout URL received');
                }
            } catch (error) {
                console.error('Checkout error:', error);
                alert('An error occurred while processing your checkout. Please try again.');
                
                // Re-enable the button
                if (checkoutBtn) {
                    checkoutBtn.disabled = false;
                    checkoutBtn.textContent = 'Proceed to Checkout';
                }
            }
        }
        
        // Hook into addItemToCart to refresh cart display when items are added
        const originalAddToCart = window.addItemToCart;
        window.addItemToCart = function(productId) {
            originalAddToCart(productId);
            displayCart();
        };
        
        // Display cart on page load
        document.addEventListener('DOMContentLoaded', displayCart);
    </script>
</body>
</html>
